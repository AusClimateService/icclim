<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Important to know &mdash; ICCLIM 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ICCLIM 0.0.1 documentation" href="index.html" />
    <link rel="next" title="Indices" href="indices.html" />
    <link rel="prev" title="Welcome to ICCLIM’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="indices.html" title="Indices"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to ICCLIM’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ICCLIM 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="important-to-know">
<h1>Important to know<a class="headerlink" href="#important-to-know" title="Permalink to this headline">¶</a></h1>
<p>Here is an overview of some important points.</p>
<div class="section" id="libraries-to-istall">
<h2>Libraries to istall<a class="headerlink" href="#libraries-to-istall" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>To use the ICCLIM you will need to install also the following python libraries:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://www.numpy.org/">NumPy</a></li>
<li><a class="reference external" href="http://netcdf4-python.googlecode.com/svn/trunk/docs/netCDF4-module.html">netCDF4</a></li>
<li><a class="reference external" href="http://docs.python.org/2/library/ctypes.html">ctypes</a></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="cf-convention">
<h2>CF convention<a class="headerlink" href="#cf-convention" title="Permalink to this headline">¶</a></h2>
<p>NetCDF files to process must be compliant to the <a class="reference external" href="http://cf-pcmdi.llnl.gov/documents/cf-conventions/">CF convention</a> (at least CF-1.0).</p>
</div>
<div class="section" id="metadata-of-output-netcdf-file">
<h2>Metadata of output NetCDF file<a class="headerlink" href="#metadata-of-output-netcdf-file" title="Permalink to this headline">¶</a></h2>
<p>ICCLIM conserves the meta data stucture of source files:</p>
<p>It copies from a source file the coordinate variables (e.g. &#8220;longitude&#8221; and &#8220;lattitude&#8221;) and all their attributs.
It also copies the attributs of time coordinate, but does not copy its values because it will recalculate the output time steps vector (and it will also create <em>time_bnds</em> variable).
It does not copy the vertical variable if it exists.
Then a result indice variable is created.
The name of this variable is the same as indice name (e.g. &#8220;FD&#8221;).
It has the following attributs:</p>
<blockquote>
<div><ul class="simple">
<li>long_name</li>
<li>units (the same units as in source files)</li>
<li>_FillValue (the same as in source files)</li>
<li>_missing_value (the same as in source files)</li>
<li>( grid_mapping )</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>According to the CF convention, the output NetCDF file contains 6 global attributs:</dt>
<dd><ul class="first last simple">
<li>title</li>
<li>institution</li>
<li>source</li>
<li>history</li>
<li>references</li>
<li>comment</li>
</ul>
</dd>
</dl>
<p>Here&#8217;s an example of an input file metadata:</p>
<div class="highlight-rest"><div class="highlight"><pre>netcdf tas_day_CNRM-CM5_historical_r1i1p1_18500101-18541231 {
dimensions:
        time = UNLIMITED ; // (1826 currently)
        lat = 128 ;
        lon = 256 ;
        bnds = 2 ;
variables:
        double time(time) ;
                time:bounds = &quot;time_bnds&quot; ;
                time:units = &quot;days since 1850-1-1&quot; ;
                time:calendar = &quot;gregorian&quot; ;
                time:axis = &quot;T&quot; ;
                time:long_name = &quot;time&quot; ;
                time:standard_name = &quot;time&quot; ;
        double time_bnds(time, bnds) ;
        double lat(lat) ;
                lat:bounds = &quot;lat_bnds&quot; ;
                lat:units = &quot;degrees_north&quot; ;
                lat:axis = &quot;Y&quot; ;
                lat:long_name = &quot;latitude&quot; ;
                lat:standard_name = &quot;latitude&quot; ;
        double lat_bnds(lat, bnds) ;
        double lon(lon) ;
                lon:bounds = &quot;lon_bnds&quot; ;
                lon:units = &quot;degrees_east&quot; ;
                lon:axis = &quot;X&quot; ;
                lon:long_name = &quot;longitude&quot; ;
                lon:standard_name = &quot;longitude&quot; ;
        double lon_bnds(lon, bnds) ;
        double height ;
                height:units = &quot;m&quot; ;
                height:axis = &quot;Z&quot; ;
                height:positive = &quot;up&quot; ;
                height:long_name = &quot;height&quot; ;
                height:standard_name = &quot;height&quot; ;
        float tas(time, lat, lon) ;
                tas:standard_name = &quot;air_temperature&quot; ;
                tas:long_name = &quot;Near-Surface Air Temperature&quot; ;
                tas:units = &quot;K&quot; ;
                tas:original_name = &quot;tas&quot; ;
                tas:cell_methods = &quot;time: mean&quot; ;
                tas:cell_measures = &quot;area: areacella&quot; ;
                tas:history = &quot;2011-04-07T06:39:36Z altered by CMOR: Treated scalar dimension: \&#39;height\&#39;.&quot; ;
                tas:coordinates = &quot;height&quot; ;
                tas:missing_value = 1.e+20f ;
                tas:_FillValue = 1.e+20f ;
                tas:associated_files = &quot;baseURL: http://cmip-pcmdi.llnl.gov/CMIP5/dataLocation gridspecFile: gridspec_atmos_fx_CNRM-CM5_historical_r0i0p0.nc areacella: areacella_fx_CNRM-CM5_historical_r0i0p0.nc&quot; ;

// global attributes:
                :institution = &quot;CNRM (Centre National de Recherches Meteorologiques, Meteo-France, Toulouse,France) and CERFACS (Centre Europeen de Recherches et de Formation Avancee en Calcul Scientifique, Toulouse, France)&quot; ;
                :institute_id = &quot;CNRM-CERFACS&quot; ;
                :experiment_id = &quot;historical&quot; ;
                <span class="nc">:source = &quot;CNRM-CM5 2010 Atmosphere:</span> <span class="nf">ARPEGE-Climat (V5.2.1, TL127L31); Ocean: NEMO (nemo3.3.v10.6.6P, ORCA1degL42); Sea Ice: GELATO (V5.30); River Routing: TRIP (v1); Land: SURFEX (v5.1.c); Coupler : OASIS 3&quot; ;</span>
                :model_id = &quot;CNRM-CM5&quot; ;
                :forcing = &quot;GHG, SA, Sl, Vl, BC, OC&quot; ;
                :parent_experiment_id = &quot;piControl&quot; ;
                :parent_experiment_rip = &quot;r1i1p1&quot; ;
                :branch_time = 146097. ;
                <span class="nc">:contact = &quot;for all but decadal predictions :</span> <span class="nf">contact.CMIP5@meteo.fr - METEO-FRANCE, CNRM/GMGEC/ASTER, CNRS URA 1357, 42 Av. Coriolis F-31057 TOULOUSE CEDEX 1 /for decadal predictions : contact.CMIP5@cerfacs.fr - CERFACS, Climate Modelling And Global Change, URA CERFACS/CNRS No1875, 42 Av. Coriolis F-31057 TOULOUSE CEDEX 1&quot; ;</span>
                <span class="nc">:comment = &quot;Soil layers depth scheme is specific for mrlsl and tsl - see variable-level comments. Atmosphere vertical hybrid coordinate :</span> <span class="nf">a_bnds and b_bnds arrays are correct, but a and b values provided are mid-sum of a_bnds and b_bnds, which is a poor approximation compared to the hydrostatic approximation actually used in the model.&quot; ;</span>
                :references = &quot;See http://www.cnrm.meteo.fr/cmip5 - Follow model description link&quot; ;
                :initialization_method = 1 ;
                :physics_version = 1 ;
                :tracking_id = &quot;cb2e6df1-075d-4bb9-a937-d9ddf8e8e56f&quot; ;
                :product = &quot;output&quot; ;
                :experiment = &quot;historical&quot; ;
                :frequency = &quot;day&quot; ;
                :creation_date = &quot;2011-04-07T06:39:40Z&quot; ;
                :history = &quot;2011-04-07T06:39:36Z CMOR rewrote data to comply with CF standards and CMIP5 requirements.&quot; ;
                :Conventions = &quot;CF-1.4&quot; ;
                :project_id = &quot;CMIP5&quot; ;
                :table_id = &quot;Table day (31 January 2011) 43a867c1fea438258e3971754e4dacea&quot; ;
                :title = &quot;CNRM-CM5 model output prepared for CMIP5 historical&quot; ;
                :parent_experiment = &quot;pre-industrial control&quot; ;
                :modeling_realm = &quot;atmos&quot; ;
                :realization = 1 ;
                :cmor_version = &quot;2.5.3&quot; ;
}
</pre></div>
</div>
<p>And here&#8217;s an example of the output metadata:</p>
<div class="highlight-rest"><div class="highlight"><pre>
</pre></div>
</div>
</div>
<div class="section" id="variable-to-process">
<h2>Variable to process<a class="headerlink" href="#variable-to-process" title="Permalink to this headline">¶</a></h2>
<p>It needs to respect the correspondence between the variable to process and the indice to calculate.
For example, the FD indice needs &#8216;<em>the daily minimum temperature</em>&#8216; variable (e.g. &#8220;tasmin&#8221;).</p>
<table border="1" class="docutils">
<colgroup>
<col width="57%" />
<col width="43%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Indice</th>
<th class="head">Variable</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>TG, GD4, GSL, HD</td>
<td>daily mean temperature</td>
</tr>
<tr class="row-odd"><td>TN, TR, TNx, CFD, FD, TNn</td>
<td>daily minimum temperature</td>
</tr>
<tr class="row-even"><td>TX, SU, TXx, CSU</td>
<td>daily maximum temperature</td>
</tr>
<tr class="row-odd"><td>DTR, ETR, vDTR</td>
<td>daily minimum + daily maimum temperature</td>
</tr>
<tr class="row-even"><td>RR, RR1, SDII, CWD, CDD, R10mm, R20mm, RX1day, RX5day</td>
<td>daily precipitation (liquide phase)</td>
</tr>
<tr class="row-odd"><td>SD, SD1, SD5cm, SD50cm</td>
<td>daily precipitation (solid phase)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="functions-description">
<h2>Functions description<a class="headerlink" href="#functions-description" title="Permalink to this headline">¶</a></h2>
<p>Here is a description of some functions.</p>
<dl class="function">
<dt>
<tt class="descname">indice(in_files_list, out_file, var, indice_name, time_range, slice_mode, project, N_lev=None):</tt></dt>
<dd><p>This function returns result NetCDF file containing a climate indice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_files_list</strong> (<em>list of str</em>) &#8211; input NetCDF files</li>
<li><strong>out_file</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; output NetCDF file</li>
<li><strong>var</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; variable name to process</li>
<li><strong>indice_name</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; climate indice name</li>
<li><strong>time_range</strong> (<em>list of 2 datetime objects [dt1, dt2]</em>) &#8211; time range (dt1 is the first day of year/month, dt2 is the last day of year/month)</li>
<li><strong>slice_mode</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; &#8220;year&#8221; for annual values, &#8220;month&#8221; for monthly values (soon: seasonal aggregation)</li>
<li><strong>project</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; project name (&#8220;CMIP5&#8221; or &#8220;CORDEX&#8221;)</li>
<li><strong>N_lev</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; level number if 4D variable (dafault: N_lev=None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output NetCDF file name</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The list of indice names are <a href="#id2"><span class="problematic" id="id3">:ref:`here &lt;indices&gt;`_</span></a> .  ############# ?????????????</p>
</div>
<dl class="function">
<dt>
<tt class="descname">SU_indice_calculation(a, fill_val, t=25):</tt></dt>
<dd><p>Calculates the indice SU: summer days (daily maximum temperature &gt; 25 degrees Celsius).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>numpy.ndarray (3D)</em>) &#8211; variable array to process (daily maximum temperature (e.g.&#8221;tasmax&#8221;))</li>
<li><strong>fill_val</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; fill value (ref.: function &#8220;get_att_value&#8221;)</li>
<li><strong>t</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; temperature threshold [degrees Celsius] (default: t = 25 degrees Celsius)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray (2D)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">CWD_indice_calculation(a, fill_val, precip_thresh=1):</tt></dt>
<dd><p>Calculates the indice CWD: maximum number of consecutive wet days (daily precipitation &gt;= 1 mm).
This function calls C function &#8220;find_max_len_consec_sequence_3d&#8221; from libC.c</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>numpy.ndarray (3D)</em>) &#8211; variable array to process (daily liquide precipitation [mm/s])</li>
<li><strong>fill_val</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; fill value (ref.: function &#8220;get_att_value&#8221;)</li>
<li><strong>precip_thresh</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; precipitation threshold [mm] (default: precip_thresh = 1 mm)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray (2D)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">check_att(nc, att):</tt></dt>
<dd><p>Checks if a global attribut exists in dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nc</strong> (<em>netCDF4.Dataset</em>) &#8211; NetCDF dataset</li>
<li><strong>att</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; attribut name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int (1 if attribut exists, 0 else)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">get_att_value(nc, var, att):</tt></dt>
<dd><p>Returns an attribut value of a variable in dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nc</strong> (<em>netCDF4.Dataset</em>) &#8211; NetCDF dataset</li>
<li><strong>var</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; variable name in dataset</li>
<li><strong>att</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; attribut name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Important to know</a><ul>
<li><a class="reference internal" href="#libraries-to-istall">Libraries to istall</a></li>
<li><a class="reference internal" href="#cf-convention">CF convention</a></li>
<li><a class="reference internal" href="#metadata-of-output-netcdf-file">Metadata of output NetCDF file</a></li>
<li><a class="reference internal" href="#variable-to-process">Variable to process</a></li>
<li><a class="reference internal" href="#functions-description">Functions description</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to ICCLIM&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="indices.html"
                        title="next chapter">Indices</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/important_to_know.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="indices.html" title="Indices"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to ICCLIM’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">ICCLIM 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, CERFACS.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>